<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2196F3">
    <title>RayoShield Exam - App</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" href="https://Lecterhdz.github.io/rayoshield-exam/assets/logo.png">
    <style>
        .logo { width: 80px; height: 80px; border-radius: 10px; background: white; padding: 5px; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <img src="assets/logo.png" alt="RayoShield" class="logo" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22150%22 height=%22150%22><rect fill=%22%232196F3%22 width=%22150%22 height=%22150%22/><text fill=%22white%22 font-size=%2260%22 x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22>RS</text></svg>'">
            <h1>RayoShield Exam</h1>
            <p>Capacitaci√≥n en Normas STPS</p>
        </div>
    </header>

    <main class="container">
        <!-- HOME -->
        <section id="home-screen" class="screen active">
            <div class="card">
                <h2>üõ°Ô∏è Bienvenido a RayoShield Exam</h2>
                <p>Eval√∫a tus conocimientos en normas de seguridad industrial STPS</p>
                
                <div id="licencia-info" style="padding:15px;background:#f5f5f5;border-radius:10px;text-align:center;font-weight:bold;margin:15px 0;">
                    üìã Licencia DEMO
                </div>
                
                <div id="usuario-info" style="padding:15px;background:#E3F2FD;border-radius:10px;margin:15px 0;font-size:14px;">
                    <!-- Se llena con JS -->
                </div>
                
                <div class="stats">
                    <div class="stat"><span class="stat-number">21</span><span class="stat-label">Ex√°menes</span></div>
                    <div class="stat"><span class="stat-number">420</span><span class="stat-label">Preguntas</span></div>
                    <div class="stat"><span class="stat-number">3</span><span class="stat-label">Niveles</span></div>
                </div>
                
                <div class="button-group">
                    <!-- Acci√≥n Principal - Azul Ejecutivo -->
                    <button class="btn btn-primary" onclick="app.irASeleccionarExamen()" id="btn-comenzar">üìö Examen</button>
    
                    <!-- Feature Premium - -->
                    <button class="btn btn-primary:hover" onclick="app.irACasosMaster()" id="btn-casos-master" style="display:none;">‚ö†Ô∏è Casos MASTER</button>
    
                    <!-- Secundarios - Gris Azulado -->
                    <button class="btn btn-secondary" onclick="app.mostrarDatosUsuario()">üìã Datos de usuario</button>
    
                    <!-- Informativo - Turquesa -->
                    <button class="btn btn-info" onclick="app.mostrarHistorial()">üìã Historial</button>
    
                    <!-- Acceso/√âxito - Verde Esmeralda -->
                    <button class="btn btn-success" onclick="app.mostrarLicencia()">üîë Licencia</button>
    
                    <!-- Secundario - Gris Azulado -->
                    <button class="btn btn-secondary" onclick="app.mostrarInfo()">‚ÑπÔ∏è Informaci√≥n</button>
    
                    <!-- Feature Premium - -->
                    <button class="btn btn-primary:hover" onclick="app.mostrarPanelWhiteLabel()" id="btn-white-label" style="display:none;">üé® Personalizar Marca</button>
                    
                </div>
            </div>
        </section>

        <!-- DATOS DE USUARIO ‚úÖ CON IDs CORRECTOS -->
        <section id="user-data-screen" class="screen">
            <div class="card">
                <h2>üìã Datos del Usuario</h2>
                <p style="color:#666;margin-bottom:20px;">Completa tus datos para comenzar los ex√°menes</p>
                
                <div class="form-group">
                    <label for="user-empresa">üè¢ Empresa</label>
                    <input type="text" id="user-empresa" placeholder="Nombre de tu empresa" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                </div>
                
                <div class="form-group">
                    <label for="user-nombre">üë§ Nombre Completo</label>
                    <input type="text" id="user-nombre" placeholder="Tu nombre completo" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                </div>
                
                <div class="form-group">
                    <label for="user-curp">üÜî CURP</label>
                    <input type="text" id="user-curp" placeholder="ABC123456HDFGHI09" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;text-transform:uppercase;">
                </div>
                
                <div class="form-group">
                    <label for="user-puesto">üíº Puesto/Cargo</label>
                    <input type="text" id="user-puesto" placeholder="Tu puesto de trabajo" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="app.guardarDatosUsuarioForm()">üíæ Guardar Datos</button>
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>

        <!-- SELECCI√ìN DE EXAMEN (agrupado por categor√≠a ‚Üí nivel) -->
        <section id="select-exam-screen" class="screen">
            <div class="card">
                <h2>üìö Selecciona un Examen</h2>
        
                <!-- Vista: Categor√≠as -->
                <div id="categorias-view">
                    <p style="color:#666;margin-bottom:20px;">Elige una categor√≠a de examen</p>
                    <div id="categorias-list" class="exam-list"></div>
                </div>
        
                <!-- Vista: Niveles (oculta por defecto) -->
                <div id="niveles-view" style="display:none;">
                    <button class="btn btn-secondary" onclick="app.volverACategorias()" style="margin-bottom:15px;">
                        ‚Üê Volver a categor√≠as
                    </button>
                    <h3 id="categoria-titulo" style="color:#2196F3;margin-bottom:10px;"></h3>
                    <p id="categoria-norma" style="color:#666;margin-bottom:20px;"></p>
                    <p style="color:#666;margin-bottom:20px;">Selecciona tu nivel:</p>
                    <div id="niveles-list" class="exam-list"></div>
                </div>
        
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>


        <!-- EXAMEN (actualizado con timer y sin bot√≥n salir) -->
        <section id="exam-screen" class="screen">
            <div class="card">
                <div class="exam-header">
                    <h3 id="exam-title">T√≠tulo del Examen</h3>
                    <p id="exam-norma" class="norma">Norma</p>
                </div>
        
                <!-- Timer de examen -->
                <div id="exam-timer" style="text-align: center; font-size: 24px; font-weight: bold; color: #666; margin: 15px 0; padding: 10px; background: #f5f5f5; border-radius: 10px;">
                    ‚è±Ô∏è 30:00
                </div>
        
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                    <p class="progress-text" id="progress-text">Pregunta 1 de 20</p>
                </div>
        
                <div class="question-container">
                    <h4 id="question-text" class="question-text">¬øPregunta?</h4>
                    <div id="options-container" class="options-container"></div>
                </div>
        
                <div class="button-group">
                    <!-- Bot√≥n de salir eliminado - el examen tiene timer -->
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Inicio</button>
                </div>
        
                <p style="text-align: center; color: #999; font-size: 12px; margin-top: 10px;">
                    ‚è∞ El examen tiene un l√≠mite de 30 minutos. Se enviar√° autom√°ticamente al terminar.
                </p>
            </div>
        </section>

        <!-- RESULTADO -->
        <section id="result-screen" class="screen">
            <div class="card result-card">
                <div class="result-icon" id="result-icon">üèÜ</div>
                <h2 id="result-title">Resultado</h2>
                <div class="score-display">
                    <span class="score-number" id="score-number">0%</span>
                    <span class="score-label">Calificaci√≥n</span>
                </div>
                <div class="result-details">
                    <p><strong>Aciertos:</strong> <span id="aciertos">0</span> de <span id="total">0</span></p>
                    <p><strong>M√≠nimo requerido:</strong> <span id="min-score">80</span>%</p>
                    <p><strong>Estado:</strong> <span id="result-status">-</span></p>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="app.descargarCertificado()" id="btn-certificado">üìÑ Descargar Certificado</button>
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>

        <!-- HISTORIAL -->
        <section id="history-screen" class="screen">
            <div class="card">
                <h2>üìã Historial de Ex√°menes</h2>
                <div id="history-list" class="history-list"></div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>

        <!-- LICENCIA (actualizado con ID + Clave) -->
        <section id="license-screen" class="screen">
            <div class="card">
                <h2>üîë Activar Licencia</h2>
        
                <div id="licencia-info-detail" style="padding:20px;background:#f5f5f5;border-radius:10px;margin:20px 0;text-align:center;font-weight:bold;">
                    üìã Licencia DEMO - 3 ex√°menes hoy
                </div>
        
                <div class="license-content">
                    <p style="color:#666;margin-bottom:20px;">Ingresa tus credenciales de licencia</p>
            
                    <!-- Campo ID de Cliente -->
                    <div class="form-group">
                        <label for="license-id">üÜî ID de Cliente</label>
                        <input type="text" id="license-id" placeholder="Ej: CONSTRUCTORA_AZTECA_001" 
                       style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;text-transform:uppercase;">
                    </div>
            
                    <!-- Campo Clave de Licencia -->
                    <div class="form-group">
                        <label for="license-key">üîê Clave de Licencia</label>
                        <input type="text" id="license-key" placeholder="Ej: RS-XXXX-YYYY-ZZZZ" 
                       style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;text-transform:uppercase;letter-spacing:2px;font-family:monospace;">
                    </div>
            
                    <button class="btn btn-primary" onclick="app.activarLicencia()" style="width:100%;margin-top:10px;">
                        üîì Activar Licencia
                    </button>
            
                    <!-- Informaci√≥n de planes ACTUALIZADA -->
                    <div style="margin-top:30px;padding:20px;background:#E3F2FD;border-radius:10px;">
                        <h4 style="color:#1976D2;margin-bottom:15px;">üí∞ Planes y Precios 2026</h4>

                        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;margin-bottom:20px;">
                            <!-- DEMO -->
                            <div style="background:white;padding:15px;border-radius:8px;border:2px solid #9E9E9E;">
                                <h5 style="color:#9E9E9E;margin-bottom:5px;">üìã DEMO</h5>
                                <p style="font-size:24px;font-weight:bold;color:#1a1a1a;">Gratis <span style="font-size:14px;color:#666;">/siempre</span></p>
                                <ul style="font-size:13px;color:#666;margin:10px 0 0 15px;">
                                    <li>1 caso b√°sico</li>
                                    <li>3 ex√°menes por d√≠a</li>
                                    <li>Certificado con marca de agua</li>
                                    <li>Acceso ilimitado a b√°sicos</li>
                                </ul>
                            </div>

                            <!-- PROFESIONAL -->
                            <div style="background:white;padding:15px;border-radius:8px;border:2px solid #4CAF50;">
                                <h5 style="color:#4CAF50;margin-bottom:5px;">üë§ PROFESIONAL</h5>
                                <p style="font-size:24px;font-weight:bold;color:#1a1a1a;">$2,499 <span style="font-size:14px;color:#666;">/a√±o</span></p>
                                <ul style="font-size:13px;color:#666;margin:10px 0 0 15px;">
                                    <li>5 casos B√ÅSICOS</li>
                                    <li>5 casos MASTER</li>
                                    <li>21 ex√°menes NOM-STPS</li>
                                    <li>Certificados sin marca de agua</li>
                                    <li>Historial completo</li>
                                </ul>
                            </div>

                            <!-- CONSULTOR (DESTACADO) -->
                            <div style="background:linear-gradient(135deg,#2196F3,#1976D2);padding:15px;border-radius:8px;border:2px solid #2196F3;transform:scale(1.05);">
                                <h5 style="color:white;margin-bottom:5px;">üíº CONSULTOR ‚≠ê</h5>
                                <p style="font-size:24px;font-weight:bold;color:white;">$7,999 <span style="font-size:14px;color:#E3F2FD;">/a√±o</span></p>
                                <ul style="font-size:13px;color:#E3F2FD;margin:10px 0 0 15px;">
                                    <li>Todo PROFESIONAL</li>
                                    <li>+3 casos ELITE</li>
                                    <li>Insignias digitales</li>
                                    <li>Dashboard b√°sico</li>
                                    <li>Soporte prioritario</li>
                                </ul>
                            </div>

                            <!-- EMPRESARIAL -->
                            <div style="background:white;padding:15px;border-radius:8px;border:2px solid #9C27B0;">
                                <h5 style="color:#9C27B0;margin-bottom:5px;">üè¢ EMPRESARIAL</h5>
                                <p style="font-size:24px;font-weight:bold;color:#1a1a1a;">$19,999 <span style="font-size:14px;color:#666;">/a√±o</span></p>
                                <ul style="font-size:13px;color:#666;margin:10px 0 0 15px;">
                                    <li>Todos los casos (15)</li>
                                    <li>+2 casos PERICIAL</li>
                                    <li>Dashboard predictivo</li>
                                    <li>Multi-usuario (50)</li>
                                    <li>Soporte dedicado</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Ofertas -->
                        <div style="background:#FFF3E0;padding:15px;border-radius:8px;border-left:4px solid #FF9800;">
                            <h5 style="color:#E65100;margin-bottom:10px;">üéâ Ofertas de Lanzamiento</h5>
                            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;font-size:14px;">
                                <div>‚Ä¢ <strong>Early Adopter:</strong> 30% descuento primeros 50</div>
                                <div>‚Ä¢ <strong>Equipos:</strong> 15% descuento 5+ licencias</div>
                                <div>‚Ä¢ <strong>Anual:</strong> 2 meses gratis</div>
                            </div>
                        </div>

                        <!-- Servicios Adicionales -->
                        <div style="margin-top:15px;background:#F3E5F5;padding:15px;border-radius:8px;border-left:4px solid #9C27B0;">
                            <h5 style="color:#7B1FA2;margin-bottom:10px;">üéì Servicios Profesionales</h5>
                            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px;font-size:13px;">
                                <div>‚Ä¢ <strong>Capacitaci√≥n:</strong> $8,000 MXN/d√≠a</div>
                                <div>‚Ä¢ <strong>Ex√°menes personalizados:</strong> $5,000 MXN/examen</div>
                                <div>‚Ä¢ <strong>Herramienta digital:</strong> Desde $30,000 MXN</div>
                                <div>‚Ä¢ <strong>Consultor√≠a SHE:</strong> Cotizaci√≥n</div>
                            </div>
                        </div>

                        <p style="margin-top:15px;color:#666;font-size:12px;">
                            <strong>üí° Nota:</strong> Precios no incluyen IVA. Todos los planes incluyen actualizaciones de contenido.<br>
                            <strong>üìû Contacto:</strong> hdzlecter@gmail.com
                        </p>
                    </div>

                </div>
        
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>


        <!-- INFORMACI√ìN -->
        <section id="info-screen" class="screen">
            <div class="card">
                <h2>‚ÑπÔ∏è Informaci√≥n</h2>
                <div class="info-content">
                    <h3>RayoShield Exam</h3>
                    <p><strong>Versi√≥n:</strong> 1.0.0</p>
                    <p><strong>Plataforma:</strong> Web (PWA)</p>
                    <h3>Ex√°menes Disponibles</h3>
                    <ul class="exam-normas">
                        <li>üîí LOTO (NOM-004-STPS-2008)</li>
                        <li>‚ö†Ô∏è Seguridad (NOM-031-STPS-2011)</li>
                        <li>ü¶∫ EPP (NOM-017-STPS-2008)</li>
                        <li>‚ö° El√©ctricos (NOM-029-STPS-2011)</li>
                        <li>üî• Est√°tica (NOM-022-STPS-2015)</li>
                        <li>üí° Iluminaci√≥n (NOM-025-STPS-2008)</li>
                    </ul>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>

        <!-- CASOS CR√çTICOS - INVESTIGACI√ìN MASTER -->
        <section id="casos-master-screen" class="screen">
            <div class="card">
                <div class="caso-header">
                    <h2>‚ö†Ô∏è Casos Cr√≠ticos de Obra</h2>
                    <p style="margin: 10px 0 0 0; opacity: 0.9;">Investigaci√≥n de incidentes - Nivel MASTER</p>
                    <div style="margin-top: 10px;">
                        <span class="badge">üîç Enfoque sist√©mico</span>
                        <span class="badge">üìä ICAM / 5 Porqu√©s</span>
                        <span class="badge badge-nivel master">MASTER</span>
                    </div>
                </div>
        
                <!-- Selector de casos -->
                <div id="casos-list" class="exam-list"></div>
        
                <!-- Vista de caso seleccionado -->
                <div id="caso-detalle" style="display: none;">
                    <!-- Metadatos del caso -->
                    <div style="background: #f5f5f5; padding: 15px; border-radius: 10px; margin: 15px 0; font-size: 14px;">
                        <strong>üìã Ficha del Caso:</strong>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                            <div><strong>ID:</strong> <span id="caso-id"></span></div>
                            <div><strong>Fecha:</strong> <span id="caso-fecha"></span></div>
                            <div><strong>Industria:</strong> <span id="caso-industria"></span></div>
                            <div><strong>Tiempo estimado:</strong> <span id="caso-tiempo"></span></div>
                        </div>
                    </div>
            
                    <!-- Descripci√≥n del evento -->
                    <div style="margin: 20px 0;">
                        <h3 style="color: #E65100; margin-bottom: 10px;">üìù Descripci√≥n del Evento</h3>
                        <p id="caso-descripcion" style="line-height: 1.6;"></p>
                    </div>
            
                    <!-- Timeline -->
                    <div style="margin: 20px 0;">
                        <h4 style="color: #1a1a1a; margin-bottom: 10px;">‚è±Ô∏è L√≠nea de Tiempo</h4>
                        <div class="timeline" id="caso-timeline"></div>
                    </div>
            
                    <!-- Energ√≠as identificadas -->
                    <div style="margin: 20px 0;">
                        <h4 style="color: #1a1a1a; margin-bottom: 10px;">‚ö° Energ√≠as Peligrosas Identificadas</h4>
                        <div class="energia-grid" id="caso-energias"></div>
                    </div>
            
                    <!-- Preguntas de investigaci√≥n -->
                    <div id="caso-preguntas" style="margin: 30px 0;"></div>
            
                    <!-- Botones de navegaci√≥n -->
                    <div class="button-group" id="caso-botones">
                        <button class="btn btn-secondary" onclick="app.volverAListaCasos()">‚Üê Otro caso</button>
                        <button class="btn btn-primary" id="btn-enviar-caso" onclick="app.enviarRespuestasCaso()" style="display: none;">‚úÖ Enviar Respuestas</button>
                    </div>
            
                    <!-- Resultado (oculto hasta enviar) -->
                    <div id="caso-resultado" style="display: none; margin-top: 30px;"></div>
                </div>
        
                <div class="button-group" id="casos-main-buttons">
                    <button class="btn btn-secondary" onclick="app.volverHome()">üè† Volver al Inicio</button>
                </div>
            </div>
        </section>
        <!-- PANEL DE CONFIGURACI√ìN WHITE LABEL -->
        <section id="white-label-screen" class="screen" style="display:none;">
            <div class="card">
                <h2>üé® Personaliza tu Marca</h2>
                <p style="color:#666;">Configura c√≥mo ver√°n tus clientes la plataforma.</p>
        
                <div class="form-group">
                    <label>Nombre de tu Empresa / Consultora</label>
                    <input type="text" id="wl-nombre" placeholder="Ej: Seguridad Industrial MX" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                </div>
        
                <div class="form-group">
                    <label>URL de tu Logo</label>
                    <input type="text" id="wl-logo" placeholder="assets/mi-logo.png" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                    <small style="color:#666;">Puedes poner una URL externa o ruta local.</small>
                </div>
        
                <div class="form-group">
                    <label>Color Primario</label>
                    <input type="color" id="wl-color" value="#2196F3" style="width:100%;height:50px;border:none;border-radius:10px;">
                </div>
        
                <div class="form-group">
                    <label>Email de Contacto</label>
                    <input type="email" id="wl-email" placeholder="contacto@tuempresa.com" style="width:100%;padding:15px;border:2px solid #ddd;border-radius:10px;font-size:16px;margin:10px 0;">
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="app.guardarWhiteLabel()">üíæ Guardar Configuraci√≥n</button>
                    <button class="btn btn-secondary" onclick="app.volverHome()">‚Ü©Ô∏è Volver</button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>¬© 2026 RayoShield. Todos los derechos reservados.</p>
        <p style="margin-top: 15px;">
            <a href="index.html">Inicio</a> |
            <a href="app.html">App</a> |
            <a href="ventas.html">Precios</a> | 
            <a href="terminos.html">T√©rminos</a> | 
            <a href="privacidad.html">Privacidad</a>
        </p>
    </footer>

    <!-- Scripts en orden correcto -->
    <script src="js/exams.js"></script>
    <script src="js/scoring.js"></script>
    <script src="js/certificate.js"></script>
    <!-- Smart Evaluation Engine 2.0 -->
    <script src="js/smart-evaluation-v2.js"></script>
    <!-- Executive Dashboard Engine -->
    <script src="js/dashboard-ejecutivo-engine.js"></script>
    <script src="js/certificate-master.js"></script>  <!-- ‚Üê AGREGAR ESTA L√çNEA -->
    <script src="js/app.js"></script>
    
    <!-- Service Worker seguro -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(reg => console.log('‚úÖ SW registrado:', reg.scope))
                .catch(err => console.log('‚ö†Ô∏è SW (no cr√≠tico):', err.message));
        }
    </script>
    <script src="js/dashboard-basico-engine.js"></script>
</body>
</html>

